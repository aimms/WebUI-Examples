<!DOCTYPE html>
<html>
	<head>
		<title>AIMMS WebUI Dev Tutorial Series</title>
		<meta data-wp-post-id="9609" />
		<link href='http://fonts.googleapis.com/css?family=Roboto:300,300italic' rel='stylesheet' type='text/css'>
		<style>
			html {
				background-color: #ECEDEF;
			}
			body {
				font-family: 'Roboto', sans-serif;
				width: 42em;
				margin: 0 auto;
				padding: 6em 4em;
				text-align: justify;
				color: #333;
				background-color: #FAFAFA;
			}
		</style>
		<!-- highightjs - syntax highlighting -->
		<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
		<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
		<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
	</head>
	<body>

		<h2 id="02-adding-dynamic-contents-part-i-options">02 - Adding dynamic contents, part I: Options</h2>
		<p>As already mentioned in <a href="../01-writing-your-first-custom-widget/index.html">tutorial-01</a>, a widget can be manipulated during its lifecycle through the AWF Option Mechanism.
			As an option value changes, the widget responds to such a change by updating its associated DOM element.
			Likewise, a widget can change the value of an option and thereby make changes in a model.
		</p>
		<p>	We specify widget-specific options inside the factory of the widget. Currently AWF supports 6 option types number, string, boolean, array, object and datasource.    </p>
		In this tutorial, we are going to dynamically update the contents of our "Hello AIMMS!" widget using an AWF option and be able to change its value through the widgets "option editor"</p>

		<h3>Adding an option in our widget</h3>
		<p>Inside the factory.js we specify the "contents" option which is of type "string". We do this inside the onInitializeOptionTypes.</p>

<pre><code class="js">
// factory.js
AWF.Bus.subscribe({
	onCollectTypes: function(collectedTypes, contextElQ) {
		if (!contextElQ || contextElQ.awf.tags("placeable")) {
			collectedTypes.push("my-widget");
		}
	},
	onDecorateElement: function(elQ, type) {
		if (type === "my-widget") {
			elQ.aimms_my_widget();
		}
	},
	onInitializeOptionTypes: function(elQ, type) {
		if (type === "my-widget") {
			elQ.awf.optionTypes("contents", AWF.OptionUtil.createOptionType("string"));
		}
	},
});

</code></pre>

		<h3>Reacting on option changes</h3>
		<p>In the widget we need to use the onResolvedOptionChanged function which reacts on option-value changes.
			We already specified the "contents" option in the factory.js so now we are able to listen for changes and react accordingly. In our case we update the text in the widget.</p>

<pre><code class="js">// jquery.aimms.my-widget.js
jQuery.widget('ui.aimms_my_widget', AWF.Widget.create({
	_create: function() {
		var widget = this;
		widget.contentElQ = $('&lt;div&gt;Hello AIMMS!&lt;/div&gt;');

		widget.element
				.find('.awf-dock.center')
				.append(widget.contentElQ);
	},
	onResolvedOptionChanged: function(optionName, optionValue) {
		var widget = this;

		if (optionName === "contents") {
			if (optionValue) {
				widget.contentElQ.text(optionValue);
			} else {
				widget.contentElQ.text("Empty contents!");
			}
		}
	},
}));
</code></pre>

		<h3>Option editor</h3>
		<p>Each option that we specify will automatically be added to the "option editor". We can access the "option editor" by clicking the gear icon (figure 1 - point 1).
		All specified option values can be updated through the "option editor". By typing inside the "contents" option textfield we can see that our widgets content is updated!
		</p>

		<picture>
			<img src="../assets/img/tut02-screenshot-1.png">
			<div><strong>figure 1</strong></div>
		</picture>

	</body>
</html>